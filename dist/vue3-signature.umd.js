(function(g,y){typeof exports=="object"&&typeof module<"u"?module.exports=y(require("vue")):typeof define=="function"&&define.amd?define(["vue"],y):(g=typeof globalThis<"u"?globalThis:g||self,g["vue3-signature"]=y(g.vue))})(this,function(g){"use strict";var bt=Object.defineProperty;var St=(g,y,A)=>y in g?bt(g,y,{enumerable:!0,configurable:!0,writable:!0,value:A}):g[y]=A;var p=(g,y,A)=>St(g,typeof y!="symbol"?y+"":y,A);/*!
 * Signature Pad v5.1.1 | https://github.com/szimek/signature_pad
 * (c) 2025 Szymon Nowak | Released under the MIT license
 */var y=class{constructor(d,h,t,e){p(this,"x");p(this,"y");p(this,"pressure");p(this,"time");if(isNaN(d)||isNaN(h))throw new Error(`Point is invalid: (${d}, ${h})`);this.x=+d,this.y=+h,this.pressure=t||0,this.time=e||Date.now()}distanceTo(d){return Math.sqrt(Math.pow(this.x-d.x,2)+Math.pow(this.y-d.y,2))}equals(d){return this.x===d.x&&this.y===d.y&&this.pressure===d.pressure&&this.time===d.time}velocityFrom(d){return this.time!==d.time?this.distanceTo(d)/(this.time-d.time):0}},A=class K{constructor(h,t,e,o,a,c){this.startPoint=h,this.control2=t,this.control1=e,this.endPoint=o,this.startWidth=a,this.endWidth=c}static fromPoints(h,t){const e=this.calculateControlPoints(h[0],h[1],h[2]).c2,o=this.calculateControlPoints(h[1],h[2],h[3]).c1;return new K(h[1],e,o,h[2],t.start,t.end)}static calculateControlPoints(h,t,e){const o=h.x-t.x,a=h.y-t.y,c=t.x-e.x,s=t.y-e.y,u={x:(h.x+t.x)/2,y:(h.y+t.y)/2},f={x:(t.x+e.x)/2,y:(t.y+e.y)/2},v=Math.sqrt(o*o+a*a),w=Math.sqrt(c*c+s*s),D=u.x-f.x,O=u.y-f.y,E=v+w==0?0:w/(v+w),M={x:f.x+D*E,y:f.y+O*E},_=t.x-M.x,T=t.y-M.y;return{c1:new y(u.x+_,u.y+T),c2:new y(f.x+_,f.y+T)}}length(){let t=0,e,o;for(let a=0;a<=10;a+=1){const c=a/10,s=this.point(c,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),u=this.point(c,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(a>0){const f=s-e,v=u-o;t+=Math.sqrt(f*f+v*v)}e=s,o=u}return t}point(h,t,e,o,a){return t*(1-h)*(1-h)*(1-h)+3*e*(1-h)*(1-h)*h+3*o*(1-h)*h*h+a*h*h*h}},Q=class{constructor(){p(this,"_et");try{this._et=new EventTarget}catch{this._et=document}}addEventListener(d,h,t){this._et.addEventListener(d,h,t)}dispatchEvent(d){return this._et.dispatchEvent(d)}removeEventListener(d,h,t){this._et.removeEventListener(d,h,t)}};function Z(d,h=250){let t=0,e=null,o,a,c;const s=()=>{t=Date.now(),e=null,o=d.apply(a,c),e||(a=null,c=[])};return function(...f){const v=Date.now(),w=h-(v-t);return a=this,c=f,w<=0||w>h?(e&&(clearTimeout(e),e=null),t=v,o=d.apply(a,c),e||(a=null,c=[])):e||(e=window.setTimeout(s,w)),o}}var tt=class j extends Q{constructor(t,e={}){super();p(this,"dotSize");p(this,"minWidth");p(this,"maxWidth");p(this,"penColor");p(this,"minDistance");p(this,"velocityFilterWeight");p(this,"compositeOperation");p(this,"backgroundColor");p(this,"throttle");p(this,"canvasContextOptions");p(this,"_ctx");p(this,"_drawingStroke",!1);p(this,"_isEmpty",!0);p(this,"_dataUrl");p(this,"_dataUrlOptions");p(this,"_lastPoints",[]);p(this,"_data",[]);p(this,"_lastVelocity",0);p(this,"_lastWidth",0);p(this,"_strokeMoveUpdate");p(this,"_strokePointerId");this.canvas=t,this.velocityFilterWeight=e.velocityFilterWeight||.7,this.minWidth=e.minWidth||.5,this.maxWidth=e.maxWidth||2.5,this.throttle=e.throttle??16,this.minDistance=e.minDistance??5,this.dotSize=e.dotSize||0,this.penColor=e.penColor||"black",this.backgroundColor=e.backgroundColor||"rgba(0,0,0,0)",this.compositeOperation=e.compositeOperation||"source-over",this.canvasContextOptions=e.canvasContextOptions??{},this._strokeMoveUpdate=this.throttle?Z(j.prototype._strokeUpdate,this.throttle):j.prototype._strokeUpdate,this._handleMouseDown=this._handleMouseDown.bind(this),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this._handleTouchStart=this._handleTouchStart.bind(this),this._handleTouchMove=this._handleTouchMove.bind(this),this._handleTouchEnd=this._handleTouchEnd.bind(this),this._handlePointerDown=this._handlePointerDown.bind(this),this._handlePointerMove=this._handlePointerMove.bind(this),this._handlePointerUp=this._handlePointerUp.bind(this),this._ctx=t.getContext("2d",this.canvasContextOptions),this.clear(),this.on()}clear(){const{_ctx:t,canvas:e}=this;t.fillStyle=this.backgroundColor,t.clearRect(0,0,e.width,e.height),t.fillRect(0,0,e.width,e.height),this._data=[],this._reset(this._getPointGroupOptions()),this._isEmpty=!0,this._dataUrl=void 0,this._dataUrlOptions=void 0,this._strokePointerId=void 0}redraw(){const t=this._data,e=this._dataUrl,o=this._dataUrlOptions;this.clear(),e&&this.fromDataURL(e,o),this.fromData(t,{clear:!1})}fromDataURL(t,e={}){return new Promise((o,a)=>{const c=new Image,s=e.ratio||window.devicePixelRatio||1,u=e.width||this.canvas.width/s,f=e.height||this.canvas.height/s,v=e.xOffset||0,w=e.yOffset||0;this._reset(this._getPointGroupOptions()),c.onload=()=>{this._ctx.drawImage(c,v,w,u,f),o()},c.onerror=D=>{a(D)},c.crossOrigin="anonymous",c.src=t,this._isEmpty=!1,this._dataUrl=t,this._dataUrlOptions={...e}})}toDataURL(t="image/png",e){switch(t){case"image/svg+xml":return typeof e!="object"&&(e=void 0),`data:image/svg+xml;base64,${btoa(this.toSVG(e))}`;default:return typeof e!="number"&&(e=void 0),this.canvas.toDataURL(t,e)}}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",this.canvas.style.userSelect="none";const t=/Macintosh/.test(navigator.userAgent)&&"ontouchstart"in document;window.PointerEvent&&!t?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.style.userSelect="auto",this.canvas.removeEventListener("pointerdown",this._handlePointerDown),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this._removeMoveUpEventListeners()}_getListenerFunctions(){const t=window.document===this.canvas.ownerDocument?window:this.canvas.ownerDocument.defaultView??this.canvas.ownerDocument;return{addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}_removeMoveUpEventListeners(){const{removeEventListener:t}=this._getListenerFunctions();t("pointermove",this._handlePointerMove),t("pointerup",this._handlePointerUp),t("mousemove",this._handleMouseMove),t("mouseup",this._handleMouseUp),t("touchmove",this._handleTouchMove),t("touchend",this._handleTouchEnd)}isEmpty(){return this._isEmpty}fromData(t,{clear:e=!0}={}){e&&this.clear(),this._fromData(t,this._drawCurve.bind(this),this._drawDot.bind(this)),this._data=this._data.concat(t)}toData(){return this._data}_isLeftButtonPressed(t,e){return e?t.buttons===1:(t.buttons&1)===1}_pointerEventToSignatureEvent(t){return{event:t,type:t.type,x:t.clientX,y:t.clientY,pressure:"pressure"in t?t.pressure:0}}_touchEventToSignatureEvent(t){const e=t.changedTouches[0];return{event:t,type:t.type,x:e.clientX,y:e.clientY,pressure:e.force}}_handleMouseDown(t){!this._isLeftButtonPressed(t,!0)||this._drawingStroke||this._strokeBegin(this._pointerEventToSignatureEvent(t))}_handleMouseMove(t){if(!this._isLeftButtonPressed(t,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(t),!1);return}this._strokeMoveUpdate(this._pointerEventToSignatureEvent(t))}_handleMouseUp(t){this._isLeftButtonPressed(t)||this._strokeEnd(this._pointerEventToSignatureEvent(t))}_handleTouchStart(t){t.targetTouches.length!==1||this._drawingStroke||(t.cancelable&&t.preventDefault(),this._strokeBegin(this._touchEventToSignatureEvent(t)))}_handleTouchMove(t){if(t.targetTouches.length===1){if(t.cancelable&&t.preventDefault(),!this._drawingStroke){this._strokeEnd(this._touchEventToSignatureEvent(t),!1);return}this._strokeMoveUpdate(this._touchEventToSignatureEvent(t))}}_handleTouchEnd(t){t.targetTouches.length===0&&(t.cancelable&&t.preventDefault(),this._strokeEnd(this._touchEventToSignatureEvent(t)))}_getPointerId(t){return t.persistentDeviceId||t.pointerId}_allowPointerId(t,e=!1){return typeof this._strokePointerId>"u"?e:this._getPointerId(t)===this._strokePointerId}_handlePointerDown(t){this._drawingStroke||!this._isLeftButtonPressed(t)||!this._allowPointerId(t,!0)||(this._strokePointerId=this._getPointerId(t),t.preventDefault(),this._strokeBegin(this._pointerEventToSignatureEvent(t)))}_handlePointerMove(t){if(this._allowPointerId(t)){if(!this._isLeftButtonPressed(t,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(t),!1);return}t.preventDefault(),this._strokeMoveUpdate(this._pointerEventToSignatureEvent(t))}}_handlePointerUp(t){this._isLeftButtonPressed(t)||!this._allowPointerId(t)||(t.preventDefault(),this._strokeEnd(this._pointerEventToSignatureEvent(t)))}_getPointGroupOptions(t){return{penColor:t&&"penColor"in t?t.penColor:this.penColor,dotSize:t&&"dotSize"in t?t.dotSize:this.dotSize,minWidth:t&&"minWidth"in t?t.minWidth:this.minWidth,maxWidth:t&&"maxWidth"in t?t.maxWidth:this.maxWidth,velocityFilterWeight:t&&"velocityFilterWeight"in t?t.velocityFilterWeight:this.velocityFilterWeight,compositeOperation:t&&"compositeOperation"in t?t.compositeOperation:this.compositeOperation}}_strokeBegin(t){if(!this.dispatchEvent(new CustomEvent("beginStroke",{detail:t,cancelable:!0})))return;const{addEventListener:o}=this._getListenerFunctions();switch(t.event.type){case"mousedown":o("mousemove",this._handleMouseMove,{passive:!1}),o("mouseup",this._handleMouseUp,{passive:!1});break;case"touchstart":o("touchmove",this._handleTouchMove,{passive:!1}),o("touchend",this._handleTouchEnd,{passive:!1});break;case"pointerdown":o("pointermove",this._handlePointerMove,{passive:!1}),o("pointerup",this._handlePointerUp,{passive:!1});break}this._drawingStroke=!0;const a=this._getPointGroupOptions(),c={...a,points:[]};this._data.push(c),this._reset(a),this._strokeUpdate(t)}_strokeUpdate(t){if(!this._drawingStroke)return;if(this._data.length===0){this._strokeBegin(t);return}this.dispatchEvent(new CustomEvent("beforeUpdateStroke",{detail:t}));const e=this._createPoint(t.x,t.y,t.pressure),o=this._data[this._data.length-1],a=o.points,c=a.length>0&&a[a.length-1],s=c?e.distanceTo(c)<=this.minDistance:!1,u=this._getPointGroupOptions(o);if(!c||!(c&&s)){const f=this._addPoint(e,u);c?f&&this._drawCurve(f,u):this._drawDot(e,u),a.push({time:e.time,x:e.x,y:e.y,pressure:e.pressure})}this.dispatchEvent(new CustomEvent("afterUpdateStroke",{detail:t}))}_strokeEnd(t,e=!0){this._removeMoveUpEventListeners(),this._drawingStroke&&(e&&this._strokeUpdate(t),this._drawingStroke=!1,this._strokePointerId=void 0,this.dispatchEvent(new CustomEvent("endStroke",{detail:t})))}_handlePointerEvents(){this._drawingStroke=!1,this.canvas.addEventListener("pointerdown",this._handlePointerDown,{passive:!1})}_handleMouseEvents(){this._drawingStroke=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown,{passive:!1})}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart,{passive:!1})}_reset(t){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(t.minWidth+t.maxWidth)/2,this._ctx.fillStyle=t.penColor,this._ctx.globalCompositeOperation=t.compositeOperation}_createPoint(t,e,o){const a=this.canvas.getBoundingClientRect();return new y(t-a.left,e-a.top,o,new Date().getTime())}_addPoint(t,e){const{_lastPoints:o}=this;if(o.push(t),o.length>2){o.length===3&&o.unshift(o[0]);const a=this._calculateCurveWidths(o[1],o[2],e),c=A.fromPoints(o,a);return o.shift(),c}return null}_calculateCurveWidths(t,e,o){const a=o.velocityFilterWeight*e.velocityFrom(t)+(1-o.velocityFilterWeight)*this._lastVelocity,c=this._strokeWidth(a,o),s={end:c,start:this._lastWidth};return this._lastVelocity=a,this._lastWidth=c,s}_strokeWidth(t,e){return Math.max(e.maxWidth/(t+1),e.minWidth)}_drawCurveSegment(t,e,o){const a=this._ctx;a.moveTo(t,e),a.arc(t,e,o,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve(t,e){const o=this._ctx,a=t.endWidth-t.startWidth,c=Math.ceil(t.length())*2;o.beginPath(),o.fillStyle=e.penColor;for(let s=0;s<c;s+=1){const u=s/c,f=u*u,v=f*u,w=1-u,D=w*w,O=D*w;let E=O*t.startPoint.x;E+=3*D*u*t.control1.x,E+=3*w*f*t.control2.x,E+=v*t.endPoint.x;let M=O*t.startPoint.y;M+=3*D*u*t.control1.y,M+=3*w*f*t.control2.y,M+=v*t.endPoint.y;const _=Math.min(t.startWidth+v*a,e.maxWidth);this._drawCurveSegment(E,M,_)}o.closePath(),o.fill()}_drawDot(t,e){const o=this._ctx,a=e.dotSize>0?e.dotSize:(e.minWidth+e.maxWidth)/2;o.beginPath(),this._drawCurveSegment(t.x,t.y,a),o.closePath(),o.fillStyle=e.penColor,o.fill()}_fromData(t,e,o){for(const a of t){const{points:c}=a,s=this._getPointGroupOptions(a);if(c.length>1)for(let u=0;u<c.length;u+=1){const f=c[u],v=new y(f.x,f.y,f.pressure,f.time);u===0&&this._reset(s);const w=this._addPoint(v,s);w&&e(w,s)}else this._reset(s),o(c[0],s)}}toSVG({includeBackgroundColor:t=!1,includeDataUrl:e=!1}={}){var w,D,O,E,M;const o=this._data,a=Math.max(window.devicePixelRatio||1,1),c=0,s=0,u=this.canvas.width/a,f=this.canvas.height/a,v=document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.setAttribute("xmlns","http://www.w3.org/2000/svg"),v.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),v.setAttribute("viewBox",`${c} ${s} ${u} ${f}`),v.setAttribute("width",u.toString()),v.setAttribute("height",f.toString()),t&&this.backgroundColor){const _=document.createElement("rect");_.setAttribute("width","100%"),_.setAttribute("height","100%"),_.setAttribute("fill",this.backgroundColor),v.appendChild(_)}if(e&&this._dataUrl){const _=((w=this._dataUrlOptions)==null?void 0:w.ratio)||window.devicePixelRatio||1,T=((D=this._dataUrlOptions)==null?void 0:D.width)||this.canvas.width/_,S=((O=this._dataUrlOptions)==null?void 0:O.height)||this.canvas.height/_,W=((E=this._dataUrlOptions)==null?void 0:E.xOffset)||0,F=((M=this._dataUrlOptions)==null?void 0:M.yOffset)||0,x=document.createElement("image");x.setAttribute("x",W.toString()),x.setAttribute("y",F.toString()),x.setAttribute("width",T.toString()),x.setAttribute("height",S.toString()),x.setAttribute("preserveAspectRatio","none"),x.setAttribute("href",this._dataUrl),v.appendChild(x)}return this._fromData(o,(_,{penColor:T})=>{const S=document.createElement("path");if(!isNaN(_.control1.x)&&!isNaN(_.control1.y)&&!isNaN(_.control2.x)&&!isNaN(_.control2.y)){const W=`M ${_.startPoint.x.toFixed(3)},${_.startPoint.y.toFixed(3)} C ${_.control1.x.toFixed(3)},${_.control1.y.toFixed(3)} ${_.control2.x.toFixed(3)},${_.control2.y.toFixed(3)} ${_.endPoint.x.toFixed(3)},${_.endPoint.y.toFixed(3)}`;S.setAttribute("d",W),S.setAttribute("stroke-width",(_.endWidth*2.25).toFixed(3)),S.setAttribute("stroke",T),S.setAttribute("fill","none"),S.setAttribute("stroke-linecap","round"),v.appendChild(S)}},(_,{penColor:T,dotSize:S,minWidth:W,maxWidth:F})=>{const x=document.createElement("circle"),z=S>0?S:(W+F)/2;x.setAttribute("r",z.toString()),x.setAttribute("cx",_.x.toString()),x.setAttribute("cy",_.y.toString()),x.setAttribute("fill",T),v.appendChild(x)}),v.outerHTML}};const et=["aria-disabled"],it={name:"Vue3Signature"},nt=g.defineComponent({...it,props:{sigOption:{type:Object,default:()=>({})},w:{type:String,default:"100%"},h:{type:String,default:"100%"},clearOnResize:{type:Boolean,default:!1},waterMark:{type:Object,default:()=>({})},disabled:{type:Boolean,default:!1},defaultUrl:{type:String,default:""}},emits:["ready","begin","end","beginStroke","endStroke","beforeUpdateStroke","afterUpdateStroke"],setup(d,{expose:h,emit:t}){const e=d,o={width:"100%",height:"100%"},a=g.ref(null),c=`canvas-${Math.random().toString(36).slice(2,9)}`,s=g.shallowRef(null),u=g.reactive({backgroundColor:"rgb(255,255,255)",penColor:"rgb(0, 0, 0)",minWidth:.5,maxWidth:2.5,...e.sigOption});let f=null;const v=new Map,w=()=>{if(typeof document>"u")return null;if(f)return f;const i=document.createElement("canvas");return i.width=1,i.height=1,f=i.getContext("2d"),f},D=i=>{if(!i)return null;if(v.has(i))return v.get(i);const n=w();if(!n)return null;n.clearRect(0,0,1,1);try{n.fillStyle=i}catch(m){return console.warn(`[vue3-signature] Unable to parse color "${i}"`,m),null}n.fillRect(0,0,1,1);const r=n.getImageData(0,0,1,1).data,l=[r[0],r[1],r[2],r[3]];return v.set(i,l),l},O=(i,n)=>{const r=i.getContext("2d");if(!r)return null;const{width:l,height:m}=i;if(l===0||m===0)return null;const b=r.getImageData(0,0,l,m).data,C=D(n);let P=m,L=l,I=-1,B=-1;const G=U=>C?b[U]===C[0]&&b[U+1]===C[1]&&b[U+2]===C[2]&&b[U+3]===C[3]:b[U+3]===0;for(let U=0;U<m;U+=1)for(let R=0;R<l;R+=1){const Et=(U*l+R)*4;G(Et)||(R<L&&(L=R),R>I&&(I=R),U<P&&(P=U),U>B&&(B=U))}if(I===-1||B===-1)return null;const Y=I-L+1,J=B-P+1;return Y<=0||J<=0?null:{x:L,y:P,width:Y,height:J}},E=[],M=i=>{i&&Object.entries(i).forEach(([n,r])=>{r!==void 0&&(u[n]=r)})},_=()=>{var i;F(),(i=s.value)==null||i.off(),s.value=null},T=i=>{let n,r=[];const l=!i.isEmpty();try{r=i.toData()}catch(m){console.warn("[vue3-signature] Failed to read signature data",m)}if(l)try{n=i.toDataURL()}catch(m){console.warn("[vue3-signature] Failed to capture dataURL",m)}return{hasSignature:l,strokes:r,dataUrl:n}},S=i=>{var n;if(!(!i||!s.value||!i.hasSignature)){if((n=i.strokes)!=null&&n.length){s.value.fromData(i.strokes);return}i.dataUrl&&s.value.fromDataURL(i.dataUrl).catch(()=>{})}},W=()=>{if(!s.value)return;F(),Object.entries({beginStroke:n=>t("beginStroke",n),endStroke:n=>t("endStroke",n),beforeUpdateStroke:n=>t("beforeUpdateStroke",n),afterUpdateStroke:n=>t("afterUpdateStroke",n)}).forEach(([n,r])=>{var m;const l=k=>{const b=k.detail;r(b)};(m=s.value)==null||m.addEventListener(n,l),E.push({type:n,listener:l})}),s.value.onBegin=()=>t("begin"),s.value.onEnd=()=>t("end")};function F(){!s.value||!E.length||(E.forEach(({type:i,listener:n})=>{var r;(r=s.value)==null||r.removeEventListener(i,n)}),E.length=0)}const x=i=>{s.value&&(i?s.value.off():s.value.on())},z=(i,n)=>{if(/px$/i.test(i)){const r=Number(i.replace(/px/gi,""));return Number.isFinite(r)?r:n}return n},$=()=>{const i=a.value,n=s.value;if(!i||!n)return;let r;!e.clearOnResize&&!n.isEmpty()&&(r=T(n));const l=Math.max(window.devicePixelRatio||1,1),m=i.parentElement,k=(m==null?void 0:m.clientWidth)??i.offsetWidth,b=(m==null?void 0:m.clientHeight)??i.offsetHeight,C=z(e.w,k),P=z(e.h,b);i.width=C*l,i.height=P*l;const L=i.getContext("2d");L==null||L.scale(l,l),n.clear(),r?S(r):Object.keys(e.waterMark).length&&N(e.waterMark)},V=i=>{!i||!s.value||s.value.fromDataURL(i).catch(()=>{})},at=i=>{var n;return i??((n=s.value)==null?void 0:n.backgroundColor)??u.backgroundColor??"rgba(0,0,0,0)"},q=i=>{const n=a.value,r=s.value;if(!n||!r||r.isEmpty())return null;const l=O(n,at(i==null?void 0:i.backgroundColor));if(!l)return null;const m=n.getContext("2d");if(!m)return null;const k=document.createElement("canvas");k.width=l.width,k.height=l.height;const b=k.getContext("2d");if(!b)return null;const C=m.getImageData(l.x,l.y,l.width,l.height);b.putImageData(C,0,0);let P;return i!=null&&i.format?P=k.toDataURL(i.format,i.encoderOptions):P=k.toDataURL(),{canvas:k,dataUrl:P,bounds:l}},rt=(i,n)=>{var r;return((r=q({format:i,encoderOptions:n}))==null?void 0:r.dataUrl)??""},N=i=>{if(Object.prototype.toString.call(i)!=="[object Object]")throw new Error("Expected Object, got "+typeof i+".");const n=a.value,r=s.value;if(!n||!r)return;const l=n.getContext("2d");if(!l)return;const{text:m="",x:k=20,y:b=20,sx:C=40,sy:P=40,font:L="20px sans-serif",fillStyle:I="#333",strokeStyle:B="#333",style:G="fill"}=i;l.save(),l.font=L,l.fillStyle=I,l.strokeStyle=B,G==="all"?(l.fillText(m,k,b),l.strokeText(m,C,P)):G==="stroke"?l.strokeText(m,C,P):l.fillText(m,k,b),l.restore(),r._isEmpty=!1},H=async(i=!1)=>{const n=a.value;if(!n)return;const r=i&&s.value?T(s.value):void 0;_(),s.value=new tt(n,{...u}),W(),x(e.disabled),await g.nextTick(),$(),r?S(r):e.defaultUrl?V(e.defaultUrl):Object.keys(e.waterMark).length&&N(e.waterMark),t("ready",s.value)},ht=()=>{var i;return(i=s.value)==null?void 0:i.clear()},lt=()=>{var i;return(i=s.value)==null?void 0:i.redraw()},X=(i,n)=>s.value?s.value.toDataURL(i,n):"",ct=i=>{var n;return((n=s.value)==null?void 0:n.toSVG(i))??""},dt=X,ut=(i,n)=>{var r;return(r=s.value)==null?void 0:r.fromDataURL(i,n)},ft=(i,n)=>{var r;return(r=s.value)==null?void 0:r.fromData(i,n)},_t=()=>{var i;return((i=s.value)==null?void 0:i.toData())??[]},vt=()=>{var i;return((i=s.value)==null?void 0:i.isEmpty())??!0},gt=()=>{var i;return(i=s.value)==null?void 0:i.on()},mt=()=>{var i;return(i=s.value)==null?void 0:i.off()},pt=(i,n,r)=>{var l;return(l=s.value)==null?void 0:l.addEventListener(i,n,r)},wt=(i,n,r)=>{var l;return(l=s.value)==null?void 0:l.removeEventListener(i,n,r)},yt=(i=1)=>{const n=s.value;if(!n||i<=0)return;const r=n.toData();r.length&&(r.splice(Math.max(r.length-i,0),i),n.fromData(r))},xt=()=>s.value;return g.watch(()=>e.sigOption,i=>{M(i),H(!0)},{deep:!0}),g.watch(()=>e.disabled,i=>x(i),{immediate:!0}),g.watch(()=>e.defaultUrl,i=>V(i)),g.watch(()=>[e.w,e.h],()=>$()),g.watch(()=>e.waterMark,i=>{i&&Object.keys(i).length&&N(i)},{deep:!0}),g.onMounted(()=>{H(),window.addEventListener("resize",$)}),g.onBeforeUnmount(()=>{window.removeEventListener("resize",$),_()}),h({clear:ht,save:dt,toDataURL:X,toTrimmedDataURL:rt,toSVG:ct,fromDataURL:ut,fromData:ft,toData:_t,redraw:lt,isEmpty:vt,undo:yt,addWaterMark:N,trim:q,enable:gt,disable:mt,addEventListener:pt,removeEventListener:wt,getInstance:xt}),(i,n)=>(g.openBlock(),g.createElementBlock("div",{class:"vue3-signature",style:g.normalizeStyle({width:d.w,height:d.h}),onTouchmove:n[0]||(n[0]=g.withModifiers(()=>{},["prevent"]))},[g.createElementVNode("canvas",{ref_key:"canvasRef",ref:a,class:g.normalizeClass(["vue3-signature__canvas",{"vue3-signature__canvas--disabled":d.disabled}]),"data-uid":c,"aria-disabled":d.disabled?"true":void 0,style:o},null,10,et)],36))}}),st=((d,h)=>{const t=d.__vccOpts||d;for(const[e,o]of h)t[e]=o;return t})(nt,[["__scopeId","data-v-c64bdf13"]]);function ot(d){return d.install=h=>{h.component(d.name,d)},d}return ot(st)});

(function(v,y){typeof exports=="object"&&typeof module<"u"?module.exports=y(require("vue")):typeof define=="function"&&define.amd?define(["vue"],y):(v=typeof globalThis<"u"?globalThis:v||self,v["vue3-signature"]=y(v.vue))})(this,function(v){"use strict";var St=Object.defineProperty;var kt=(v,y,A)=>y in v?St(v,y,{enumerable:!0,configurable:!0,writable:!0,value:A}):v[y]=A;var p=(v,y,A)=>kt(v,typeof y!="symbol"?y+"":y,A);/*!
 * Signature Pad v5.1.3 | https://github.com/szimek/signature_pad
 * (c) 2025 Szymon Nowak | Released under the MIT license
 */var y=class{constructor(d,l,t,i){p(this,"x");p(this,"y");p(this,"pressure");p(this,"time");if(isNaN(d)||isNaN(l))throw new Error(`Point is invalid: (${d}, ${l})`);this.x=+d,this.y=+l,this.pressure=t||0,this.time=i||Date.now()}distanceTo(d){return Math.sqrt(Math.pow(this.x-d.x,2)+Math.pow(this.y-d.y,2))}equals(d){return this.x===d.x&&this.y===d.y&&this.pressure===d.pressure&&this.time===d.time}velocityFrom(d){return this.time!==d.time?this.distanceTo(d)/(this.time-d.time):0}},A=class Q{constructor(l,t,i,n,a,h){this.startPoint=l,this.control2=t,this.control1=i,this.endPoint=n,this.startWidth=a,this.endWidth=h}static fromPoints(l,t){const i=this.calculateControlPoints(l[0],l[1],l[2]).c2,n=this.calculateControlPoints(l[1],l[2],l[3]).c1;return new Q(l[1],i,n,l[2],t.start,t.end)}static calculateControlPoints(l,t,i){const n=l.x-t.x,a=l.y-t.y,h=t.x-i.x,g=t.y-i.y,o={x:(l.x+t.x)/2,y:(l.y+t.y)/2},u={x:(t.x+i.x)/2,y:(t.y+i.y)/2},f=Math.sqrt(n*n+a*a),w=Math.sqrt(h*h+g*g),U=o.x-u.x,O=o.y-u.y,D=f+w==0?0:w/(f+w),E={x:u.x+U*D,y:u.y+O*D},_=t.x-E.x,T=t.y-E.y;return{c1:new y(o.x+_,o.y+T),c2:new y(u.x+_,u.y+T)}}length(){let t=0,i,n;for(let a=0;a<=10;a+=1){const h=a/10,g=this.point(h,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),o=this.point(h,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(a>0){const u=g-i,f=o-n;t+=Math.sqrt(u*u+f*f)}i=g,n=o}return t}point(l,t,i,n,a){return t*(1-l)*(1-l)*(1-l)+3*i*(1-l)*(1-l)*l+3*n*(1-l)*l*l+a*l*l*l}},Z=class{constructor(){p(this,"_et");try{this._et=new EventTarget}catch{this._et=document}}addEventListener(d,l,t){this._et.addEventListener(d,l,t)}dispatchEvent(d){return this._et.dispatchEvent(d)}removeEventListener(d,l,t){this._et.removeEventListener(d,l,t)}};function tt(d,l=250){let t=0,i=null,n,a,h;const g=()=>{t=Date.now(),i=null,n=d.apply(a,h),i||(a=null,h=[])};return function(...u){const f=Date.now(),w=l-(f-t);return a=this,h=u,w<=0||w>l?(i&&(clearTimeout(i),i=null),t=f,n=d.apply(a,h),i||(a=null,h=[])):i||(i=window.setTimeout(g,w)),n}}var et=class j extends Z{constructor(t,i={}){super();p(this,"dotSize");p(this,"minWidth");p(this,"maxWidth");p(this,"penColor");p(this,"minDistance");p(this,"velocityFilterWeight");p(this,"compositeOperation");p(this,"backgroundColor");p(this,"throttle");p(this,"canvasContextOptions");p(this,"_ctx");p(this,"_drawingStroke",!1);p(this,"_isEmpty",!0);p(this,"_dataUrl");p(this,"_dataUrlOptions");p(this,"_lastPoints",[]);p(this,"_data",[]);p(this,"_lastVelocity",0);p(this,"_lastWidth",0);p(this,"_strokeMoveUpdate");p(this,"_strokePointerId");this.canvas=t,this.velocityFilterWeight=i.velocityFilterWeight||.7,this.minWidth=i.minWidth||.5,this.maxWidth=i.maxWidth||2.5,this.throttle=i.throttle??16,this.minDistance=i.minDistance??5,this.dotSize=i.dotSize||0,this.penColor=i.penColor||"black",this.backgroundColor=i.backgroundColor||"rgba(0,0,0,0)",this.compositeOperation=i.compositeOperation||"source-over",this.canvasContextOptions=i.canvasContextOptions??{},this._strokeMoveUpdate=this.throttle?tt(j.prototype._strokeUpdate,this.throttle):j.prototype._strokeUpdate,this._handleMouseDown=this._handleMouseDown.bind(this),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this._handleTouchStart=this._handleTouchStart.bind(this),this._handleTouchMove=this._handleTouchMove.bind(this),this._handleTouchEnd=this._handleTouchEnd.bind(this),this._handlePointerDown=this._handlePointerDown.bind(this),this._handlePointerMove=this._handlePointerMove.bind(this),this._handlePointerUp=this._handlePointerUp.bind(this),this._handlePointerCancel=this._handlePointerCancel.bind(this),this._handleTouchCancel=this._handleTouchCancel.bind(this),this._ctx=t.getContext("2d",this.canvasContextOptions),this.clear(),this.on()}clear(){const{_ctx:t,canvas:i}=this;t.fillStyle=this.backgroundColor,t.clearRect(0,0,i.width,i.height),t.fillRect(0,0,i.width,i.height),this._data=[],this._reset(this._getPointGroupOptions()),this._isEmpty=!0,this._dataUrl=void 0,this._dataUrlOptions=void 0,this._strokePointerId=void 0}redraw(){const t=this._data,i=this._dataUrl,n=this._dataUrlOptions;this.clear(),i&&this.fromDataURL(i,n),this.fromData(t,{clear:!1})}fromDataURL(t,i={}){return new Promise((n,a)=>{const h=new Image,g=i.ratio||window.devicePixelRatio||1,o=i.width||this.canvas.width/g,u=i.height||this.canvas.height/g,f=i.xOffset||0,w=i.yOffset||0;this._reset(this._getPointGroupOptions()),h.onload=()=>{this._ctx.drawImage(h,f,w,o,u),n()},h.onerror=U=>{a(U)},h.crossOrigin="anonymous",h.src=t,this._isEmpty=!1,this._dataUrl=t,this._dataUrlOptions={...i}})}toDataURL(t="image/png",i){switch(t){case"image/svg+xml":return typeof i!="object"&&(i=void 0),`data:image/svg+xml;base64,${btoa(this.toSVG(i))}`;default:return typeof i!="number"&&(i=void 0),this.canvas.toDataURL(t,i)}}on(){this.canvas.style.touchAction="none",this.canvas.style.msTouchAction="none",this.canvas.style.userSelect="none",this.canvas.style.webkitUserSelect="none";const t=/Macintosh/.test(navigator.userAgent)&&"ontouchstart"in document;window.PointerEvent&&!t?this._handlePointerEvents():(this._handleMouseEvents(),"ontouchstart"in window&&this._handleTouchEvents())}off(){this.canvas.style.touchAction="auto",this.canvas.style.msTouchAction="auto",this.canvas.style.userSelect="auto",this.canvas.style.webkitUserSelect="auto",this.canvas.removeEventListener("pointerdown",this._handlePointerDown),this.canvas.removeEventListener("mousedown",this._handleMouseDown),this.canvas.removeEventListener("touchstart",this._handleTouchStart),this._removeMoveUpEventListeners()}_getListenerFunctions(){const t=window.document===this.canvas.ownerDocument?window:this.canvas.ownerDocument.defaultView??this.canvas.ownerDocument;return{addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}_removeMoveUpEventListeners(){const{removeEventListener:t}=this._getListenerFunctions();t("pointermove",this._handlePointerMove),t("pointerup",this._handlePointerUp),t("pointercancel",this._handlePointerCancel),t("mousemove",this._handleMouseMove),t("mouseup",this._handleMouseUp),t("touchmove",this._handleTouchMove),t("touchend",this._handleTouchEnd),t("touchcancel",this._handleTouchCancel)}isEmpty(){return this._isEmpty}fromData(t,{clear:i=!0}={}){i&&this.clear(),this._fromData(t,this._drawCurve.bind(this),this._drawDot.bind(this)),this._data=this._data.concat(t)}toData(){return this._data}_isLeftButtonPressed(t,i){return i?t.buttons===1:(t.buttons&1)===1}_pointerEventToSignatureEvent(t){return{event:t,type:t.type,x:t.clientX,y:t.clientY,pressure:"pressure"in t?t.pressure:0}}_touchEventToSignatureEvent(t){const i=t.changedTouches[0];return{event:t,type:t.type,x:i.clientX,y:i.clientY,pressure:i.force}}_handleMouseDown(t){!this._isLeftButtonPressed(t,!0)||this._drawingStroke||this._strokeBegin(this._pointerEventToSignatureEvent(t))}_handleMouseMove(t){if(!this._isLeftButtonPressed(t,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(t),!1);return}this._strokeMoveUpdate(this._pointerEventToSignatureEvent(t))}_handleMouseUp(t){this._isLeftButtonPressed(t)||this._strokeEnd(this._pointerEventToSignatureEvent(t))}_handleTouchStart(t){t.targetTouches.length!==1||this._drawingStroke||(t.cancelable&&t.preventDefault(),this._strokeBegin(this._touchEventToSignatureEvent(t)))}_handleTouchMove(t){if(t.targetTouches.length===1){if(t.cancelable&&t.preventDefault(),!this._drawingStroke){this._strokeEnd(this._touchEventToSignatureEvent(t),!1);return}this._strokeMoveUpdate(this._touchEventToSignatureEvent(t))}}_handleTouchEnd(t){t.targetTouches.length===0&&(t.cancelable&&t.preventDefault(),this._strokeEnd(this._touchEventToSignatureEvent(t)))}_handlePointerCancel(t){this._allowPointerId(t)&&(t.preventDefault(),this._strokeEnd(this._pointerEventToSignatureEvent(t),!1))}_handleTouchCancel(t){t.cancelable&&t.preventDefault(),this._strokeEnd(this._touchEventToSignatureEvent(t),!1)}_getPointerId(t){return t.persistentDeviceId||t.pointerId}_allowPointerId(t,i=!1){return typeof this._strokePointerId>"u"?i:this._getPointerId(t)===this._strokePointerId}_handlePointerDown(t){this._drawingStroke||!this._isLeftButtonPressed(t)||!this._allowPointerId(t,!0)||(this._strokePointerId=this._getPointerId(t),t.preventDefault(),this._strokeBegin(this._pointerEventToSignatureEvent(t)))}_handlePointerMove(t){if(this._allowPointerId(t)){if(!this._isLeftButtonPressed(t,!0)||!this._drawingStroke){this._strokeEnd(this._pointerEventToSignatureEvent(t),!1);return}t.preventDefault(),this._strokeMoveUpdate(this._pointerEventToSignatureEvent(t))}}_handlePointerUp(t){this._isLeftButtonPressed(t)||!this._allowPointerId(t)||(t.preventDefault(),this._strokeEnd(this._pointerEventToSignatureEvent(t)))}_getPointGroupOptions(t){return{penColor:t&&"penColor"in t?t.penColor:this.penColor,dotSize:t&&"dotSize"in t?t.dotSize:this.dotSize,minWidth:t&&"minWidth"in t?t.minWidth:this.minWidth,maxWidth:t&&"maxWidth"in t?t.maxWidth:this.maxWidth,velocityFilterWeight:t&&"velocityFilterWeight"in t?t.velocityFilterWeight:this.velocityFilterWeight,compositeOperation:t&&"compositeOperation"in t?t.compositeOperation:this.compositeOperation}}_strokeBegin(t){if(!this.dispatchEvent(new CustomEvent("beginStroke",{detail:t,cancelable:!0})))return;const{addEventListener:n}=this._getListenerFunctions();switch(t.event.type){case"mousedown":n("mousemove",this._handleMouseMove,{passive:!1}),n("mouseup",this._handleMouseUp,{passive:!1});break;case"touchstart":n("touchmove",this._handleTouchMove,{passive:!1}),n("touchend",this._handleTouchEnd,{passive:!1}),n("touchcancel",this._handleTouchCancel,{passive:!1});break;case"pointerdown":n("pointermove",this._handlePointerMove,{passive:!1}),n("pointerup",this._handlePointerUp,{passive:!1}),n("pointercancel",this._handlePointerCancel,{passive:!1});break}this._drawingStroke=!0;const a=this._getPointGroupOptions(),h={...a,points:[]};this._data.push(h),this._reset(a),this._strokeUpdate(t)}_strokeUpdate(t){if(!this._drawingStroke)return;if(this._data.length===0){this._strokeBegin(t);return}this.dispatchEvent(new CustomEvent("beforeUpdateStroke",{detail:t}));const i=this._createPoint(t.x,t.y,t.pressure),n=this._data[this._data.length-1],a=n.points,h=a.length>0&&a[a.length-1],g=h?i.distanceTo(h)<=this.minDistance:!1,o=this._getPointGroupOptions(n);if(!h||!(h&&g)){const u=this._addPoint(i,o);h?u&&this._drawCurve(u,o):this._drawDot(i,o),a.push({time:i.time,x:i.x,y:i.y,pressure:i.pressure})}this.dispatchEvent(new CustomEvent("afterUpdateStroke",{detail:t}))}_strokeEnd(t,i=!0){this._removeMoveUpEventListeners(),this._drawingStroke&&(i&&this._strokeUpdate(t),this._drawingStroke=!1,this._strokePointerId=void 0,this.dispatchEvent(new CustomEvent("endStroke",{detail:t})))}_handlePointerEvents(){this._drawingStroke=!1,this.canvas.addEventListener("pointerdown",this._handlePointerDown,{passive:!1})}_handleMouseEvents(){this._drawingStroke=!1,this.canvas.addEventListener("mousedown",this._handleMouseDown,{passive:!1})}_handleTouchEvents(){this.canvas.addEventListener("touchstart",this._handleTouchStart,{passive:!1})}_reset(t){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(t.minWidth+t.maxWidth)/2,this._ctx.fillStyle=t.penColor,this._ctx.globalCompositeOperation=t.compositeOperation}_createPoint(t,i,n){const a=this.canvas.getBoundingClientRect();return new y(t-a.left,i-a.top,n,new Date().getTime())}_addPoint(t,i){const{_lastPoints:n}=this;if(n.push(t),n.length>2){n.length===3&&n.unshift(n[0]);const a=this._calculateCurveWidths(n[1],n[2],i),h=A.fromPoints(n,a);return n.shift(),h}return null}_calculateCurveWidths(t,i,n){const a=n.velocityFilterWeight*i.velocityFrom(t)+(1-n.velocityFilterWeight)*this._lastVelocity,h=this._strokeWidth(a,n),g={end:h,start:this._lastWidth};return this._lastVelocity=a,this._lastWidth=h,g}_strokeWidth(t,i){return Math.max(i.maxWidth/(t+1),i.minWidth)}_drawCurveSegment(t,i,n){const a=this._ctx;a.moveTo(t,i),a.arc(t,i,n,0,2*Math.PI,!1),this._isEmpty=!1}_drawCurve(t,i){const n=this._ctx,a=t.endWidth-t.startWidth,h=Math.ceil(t.length())*2;n.beginPath(),n.fillStyle=i.penColor;for(let g=0;g<h;g+=1){const o=g/h,u=o*o,f=u*o,w=1-o,U=w*w,O=U*w;let D=O*t.startPoint.x;D+=3*U*o*t.control1.x,D+=3*w*u*t.control2.x,D+=f*t.endPoint.x;let E=O*t.startPoint.y;E+=3*U*o*t.control1.y,E+=3*w*u*t.control2.y,E+=f*t.endPoint.y;const _=Math.min(t.startWidth+f*a,i.maxWidth);this._drawCurveSegment(D,E,_)}n.closePath(),n.fill()}_drawDot(t,i){const n=this._ctx,a=i.dotSize>0?i.dotSize:(i.minWidth+i.maxWidth)/2;n.beginPath(),this._drawCurveSegment(t.x,t.y,a),n.closePath(),n.fillStyle=i.penColor,n.fill()}_fromData(t,i,n){for(const a of t){const{points:h}=a,g=this._getPointGroupOptions(a);if(h.length>1)for(let o=0;o<h.length;o+=1){const u=h[o],f=new y(u.x,u.y,u.pressure,u.time);o===0&&this._reset(g);const w=this._addPoint(f,g);w&&i(w,g)}else this._reset(g),n(h[0],g)}}toSVG({includeBackgroundColor:t=!1,includeDataUrl:i=!1}={}){var w,U,O,D,E;const n=this._data,a=Math.max(window.devicePixelRatio||1,1),h=0,g=0,o=this.canvas.width/a,u=this.canvas.height/a,f=document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.setAttribute("xmlns","http://www.w3.org/2000/svg"),f.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),f.setAttribute("viewBox",`${h} ${g} ${o} ${u}`),f.setAttribute("width",o.toString()),f.setAttribute("height",u.toString()),t&&this.backgroundColor){const _=document.createElement("rect");_.setAttribute("width","100%"),_.setAttribute("height","100%"),_.setAttribute("fill",this.backgroundColor),f.appendChild(_)}if(i&&this._dataUrl){const _=((w=this._dataUrlOptions)==null?void 0:w.ratio)||window.devicePixelRatio||1,T=((U=this._dataUrlOptions)==null?void 0:U.width)||this.canvas.width/_,S=((O=this._dataUrlOptions)==null?void 0:O.height)||this.canvas.height/_,W=((D=this._dataUrlOptions)==null?void 0:D.xOffset)||0,B=((E=this._dataUrlOptions)==null?void 0:E.yOffset)||0,x=document.createElement("image");x.setAttribute("x",W.toString()),x.setAttribute("y",B.toString()),x.setAttribute("width",T.toString()),x.setAttribute("height",S.toString()),x.setAttribute("preserveAspectRatio","none"),x.setAttribute("href",this._dataUrl),f.appendChild(x)}return this._fromData(n,(_,{penColor:T})=>{const S=document.createElement("path");if(!isNaN(_.control1.x)&&!isNaN(_.control1.y)&&!isNaN(_.control2.x)&&!isNaN(_.control2.y)){const W=`M ${_.startPoint.x.toFixed(3)},${_.startPoint.y.toFixed(3)} C ${_.control1.x.toFixed(3)},${_.control1.y.toFixed(3)} ${_.control2.x.toFixed(3)},${_.control2.y.toFixed(3)} ${_.endPoint.x.toFixed(3)},${_.endPoint.y.toFixed(3)}`;S.setAttribute("d",W),S.setAttribute("stroke-width",(_.endWidth*2.25).toFixed(3)),S.setAttribute("stroke",T),S.setAttribute("fill","none"),S.setAttribute("stroke-linecap","round"),f.appendChild(S)}},(_,{penColor:T,dotSize:S,minWidth:W,maxWidth:B})=>{const x=document.createElement("circle"),z=S>0?S:(W+B)/2;x.setAttribute("r",z.toString()),x.setAttribute("cx",_.x.toString()),x.setAttribute("cy",_.y.toString()),x.setAttribute("fill",T),f.appendChild(x)}),f.outerHTML}};const it=["aria-disabled"],nt={name:"Vue3Signature"},st=v.defineComponent({...nt,props:{sigOption:{type:Object,default:()=>({})},w:{type:String,default:"100%"},h:{type:String,default:"100%"},clearOnResize:{type:Boolean,default:!1},waterMark:{type:Object,default:()=>({})},disabled:{type:Boolean,default:!1},defaultUrl:{type:String,default:""}},emits:["ready","begin","end","beginStroke","endStroke","beforeUpdateStroke","afterUpdateStroke"],setup(d,{expose:l,emit:t}){const i={width:"100%",height:"100%"},n=t,a=d,h=v.ref(null),g=`canvas-${Math.random().toString(36).slice(2,9)}`,o=v.shallowRef(null),u=v.reactive({backgroundColor:"rgb(255,255,255)",penColor:"rgb(0, 0, 0)",minWidth:.5,maxWidth:2.5,...a.sigOption});let f=null;const w=new Map,U=()=>{if(typeof document>"u")return null;if(f)return f;const e=document.createElement("canvas");return e.width=1,e.height=1,f=e.getContext("2d"),f},O=e=>{if(!e)return null;if(w.has(e))return w.get(e);const s=U();if(!s)return null;s.clearRect(0,0,1,1);try{s.fillStyle=e}catch(m){return console.warn(`[vue3-signature] Unable to parse color "${e}"`,m),null}s.fillRect(0,0,1,1);const r=s.getImageData(0,0,1,1).data,c=[r[0],r[1],r[2],r[3]];return w.set(e,c),c},D=(e,s)=>{const r=e.getContext("2d");if(!r)return null;const{width:c,height:m}=e;if(c===0||m===0)return null;const b=r.getImageData(0,0,c,m).data,M=O(s);let P=m,L=c,I=-1,F=-1;const G=C=>M?b[C]===M[0]&&b[C+1]===M[1]&&b[C+2]===M[2]&&b[C+3]===M[3]:b[C+3]===0;for(let C=0;C<m;C+=1)for(let R=0;R<c;R+=1){const bt=(C*c+R)*4;G(bt)||(R<L&&(L=R),R>I&&(I=R),C<P&&(P=C),C>F&&(F=C))}if(I===-1||F===-1)return null;const J=I-L+1,K=F-P+1;return J<=0||K<=0?null:{x:L,y:P,width:J,height:K}},E=[],_=e=>{e&&Object.entries(e).forEach(([s,r])=>{r!==void 0&&(u[s]=r)})},T=()=>{var e;x(),(e=o.value)==null||e.off(),o.value=null},S=e=>{let s,r=[];const c=!e.isEmpty();try{r=e.toData()}catch(m){console.warn("[vue3-signature] Failed to read signature data",m)}if(c)try{s=e.toDataURL()}catch(m){console.warn("[vue3-signature] Failed to capture dataURL",m)}return{hasSignature:c,strokes:r,dataUrl:s}},W=e=>{var s;if(!(!e||!o.value||!e.hasSignature)){if((s=e.strokes)!=null&&s.length){o.value.fromData(e.strokes);return}e.dataUrl&&o.value.fromDataURL(e.dataUrl).catch(()=>{})}},B=()=>{if(!o.value)return;x(),Object.entries({beginStroke:s=>n("beginStroke",s),endStroke:s=>n("endStroke",s),beforeUpdateStroke:s=>n("beforeUpdateStroke",s),afterUpdateStroke:s=>n("afterUpdateStroke",s)}).forEach(([s,r])=>{var m;const c=k=>{const b=k.detail;r(b)};(m=o.value)==null||m.addEventListener(s,c),E.push({type:s,listener:c})}),o.value.onBegin=()=>n("begin"),o.value.onEnd=()=>n("end")};function x(){!o.value||!E.length||(E.forEach(({type:e,listener:s})=>{var r;(r=o.value)==null||r.removeEventListener(e,s)}),E.length=0)}const z=e=>{o.value&&(e?o.value.off():o.value.on())},V=(e,s)=>{if(/px$/i.test(e)){const r=Number(e.replace(/px/gi,""));return Number.isFinite(r)?r:s}return s},$=()=>{const e=h.value,s=o.value;if(!e||!s)return;let r;!a.clearOnResize&&!s.isEmpty()&&(r=S(s));const c=Math.max(window.devicePixelRatio||1,1),m=e.parentElement,k=(m==null?void 0:m.clientWidth)??e.offsetWidth,b=(m==null?void 0:m.clientHeight)??e.offsetHeight,M=V(a.w,k),P=V(a.h,b);e.width=M*c,e.height=P*c;const L=e.getContext("2d");L==null||L.scale(c,c),s.clear(),r?W(r):Object.keys(a.waterMark).length&&N(a.waterMark)},q=e=>{!e||!o.value||o.value.fromDataURL(e).catch(()=>{})},rt=e=>{var s;return e??((s=o.value)==null?void 0:s.backgroundColor)??u.backgroundColor??"rgba(0,0,0,0)"},H=e=>{const s=h.value,r=o.value;if(!s||!r||r.isEmpty())return null;const c=D(s,rt(e==null?void 0:e.backgroundColor));if(!c)return null;const m=s.getContext("2d");if(!m)return null;const k=document.createElement("canvas");k.width=c.width,k.height=c.height;const b=k.getContext("2d");if(!b)return null;const M=m.getImageData(c.x,c.y,c.width,c.height);b.putImageData(M,0,0);let P;return e!=null&&e.format?P=k.toDataURL(e.format,e.encoderOptions):P=k.toDataURL(),{canvas:k,dataUrl:P,bounds:c}},ht=(e,s)=>{var r;return((r=H({format:e,encoderOptions:s}))==null?void 0:r.dataUrl)??""},N=e=>{if(Object.prototype.toString.call(e)!=="[object Object]")throw new Error("Expected Object, got "+typeof e+".");const s=h.value,r=o.value;if(!s||!r)return;const c=s.getContext("2d");if(!c)return;const{text:m="",x:k=20,y:b=20,sx:M=40,sy:P=40,font:L="20px sans-serif",fillStyle:I="#333",strokeStyle:F="#333",style:G="fill"}=e;c.save(),c.font=L,c.fillStyle=I,c.strokeStyle=F,G==="all"?(c.fillText(m,k,b),c.strokeText(m,M,P)):G==="stroke"?c.strokeText(m,M,P):c.fillText(m,k,b),c.restore(),r._isEmpty=!1},X=async(e=!1)=>{const s=h.value;if(!s)return;const r=e&&o.value?S(o.value):void 0;T(),o.value=new et(s,{...u}),B(),z(a.disabled),await v.nextTick(),$(),r?W(r):a.defaultUrl?q(a.defaultUrl):Object.keys(a.waterMark).length&&N(a.waterMark),n("ready",o.value)},lt=()=>{var e;return(e=o.value)==null?void 0:e.clear()},ct=()=>{var e;return(e=o.value)==null?void 0:e.redraw()},Y=(e,s)=>o.value?o.value.toDataURL(e,s):"",dt=e=>{var s;return((s=o.value)==null?void 0:s.toSVG(e))??""},ut=Y,ft=(e,s)=>{var r;return(r=o.value)==null?void 0:r.fromDataURL(e,s)},_t=(e,s)=>{var r;return(r=o.value)==null?void 0:r.fromData(e,s)},vt=()=>{var e;return((e=o.value)==null?void 0:e.toData())??[]},gt=()=>{var e;return((e=o.value)==null?void 0:e.isEmpty())??!0},mt=()=>{var e;return(e=o.value)==null?void 0:e.on()},pt=()=>{var e;return(e=o.value)==null?void 0:e.off()},wt=(e,s,r)=>{var c;return(c=o.value)==null?void 0:c.addEventListener(e,s,r)},yt=(e,s,r)=>{var c;return(c=o.value)==null?void 0:c.removeEventListener(e,s,r)},xt=(e=1)=>{const s=o.value;if(!s||e<=0)return;const r=s.toData();r.length&&(r.splice(Math.max(r.length-e,0),e),s.fromData(r))},Et=()=>o.value;return v.watch(()=>a.sigOption,e=>{_(e),X(!0)},{deep:!0}),v.watch(()=>a.disabled,e=>z(e),{immediate:!0}),v.watch(()=>a.defaultUrl,e=>q(e)),v.watch(()=>[a.w,a.h],()=>$()),v.watch(()=>a.waterMark,e=>{e&&Object.keys(e).length&&N(e)},{deep:!0}),v.onMounted(()=>{X(),window.addEventListener("resize",$)}),v.onBeforeUnmount(()=>{window.removeEventListener("resize",$),T()}),l({clear:lt,save:ut,toDataURL:Y,toTrimmedDataURL:ht,toSVG:dt,fromDataURL:ft,fromData:_t,toData:vt,redraw:ct,isEmpty:gt,undo:xt,addWaterMark:N,trim:H,enable:mt,disable:pt,addEventListener:wt,removeEventListener:yt,getInstance:Et}),(e,s)=>(v.openBlock(),v.createElementBlock("div",{class:"vue3-signature",style:v.normalizeStyle({width:d.w,height:d.h}),onTouchmove:s[0]||(s[0]=v.withModifiers(()=>{},["prevent"]))},[v.createElementVNode("canvas",{ref_key:"canvasRef",ref:h,class:v.normalizeClass(["vue3-signature__canvas",{"vue3-signature__canvas--disabled":d.disabled}]),"data-uid":g,"aria-disabled":d.disabled?"true":void 0,style:i},null,10,it)],36))}}),ot=((d,l)=>{const t=d.__vccOpts||d;for(const[i,n]of l)t[i]=n;return t})(st,[["__scopeId","data-v-66fe26ed"]]);function at(d){return d.install=l=>{l.component(d.name,d)},d}return at(ot)});
